# 从JS源码分析到任意用户登录-先知社区

> **来源**: https://xz.aliyun.com/news/16392  
> **文章ID**: 16392

---

# 声明

本文章所分享内容仅用于网络安全技术讨论，切勿用于违法途径，所有渗透都需获取授权，违者后果自行承担，与本号及作者无关，请谨记守法.  
此文章不允许未经授权转发至除先知社区以外的其它平台！！！

# 前言

此网站是某个众测的项目，主要漏洞还是通过前端源码分析到任意用户登录，攻击者可据构造认证数据包进行任意用户登录从而获取用户数据，比较经典。

# 漏洞

老样子，开局登录框，这一步把小狐狸打开，使用burp检测网站的所有接口数据

![](images/20241229222831-2d9eb8aa-c5f1-1.png)  
发现某js文件泄露appId以及clientId

![](images/20241229222839-3263083c-c5f1-1.png)  
通过查看小熊猫插件发现/auth/oauth/token接口

![](images/20241229222847-372e21bc-c5f1-1.png)  
查看前端源码，全局搜索该接口

![](images/20241229222854-3b17ac76-c5f1-1.png)  
我们通过上述源码逻辑发现token生成格式为

```
Authorization = 'Basic ' + btoa(''.concat(o, ':').concat(c))
```

其中o为clientId，c为appId，在使用btoa函数进行处理，而btoa函数到底是什么直接浏览器搜索或者问AI也行

![](images/20241229222902-404ace76-c5f1-1.png)  
我们也可直接通过浏览器控制台使用btoa函数进行处理我们想要的字段即可，如下图：

![](images/20241229222910-45150458-c5f1-1.png)  
最终形成这种格式

```
Authorization： Basic dnhpxxxxxxxxxxxxxxxx
```

构造数据包获取token

![](images/20241229222918-49848892-c5f1-1.png)  
查看登录接口，可以发现主要通过userId进行登录控制用户名

![](images/20241229222924-4d5b2584-c5f1-1.png)  
因此我们可以构造登录认证的链接并指定userid进行任意用户登录

![](images/20241229222930-50e168bc-c5f1-1.png)  
登录成功，获取到姓名，手机号等信息

![](images/20241229222937-54e4f0c8-c5f1-1.png)
