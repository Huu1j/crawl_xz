# 内存取证各大平台例题-先知社区

> **来源**: https://xz.aliyun.com/news/16735  
> **文章ID**: 16735

---

### GHCTF 2024 的三道取证题

#### [GHCTF 2024 新生赛]皆非取证

vol.py -f chall.vmem --profile=Win7SP1x64 filescan | grep zip

![](images/20250213162454-009bb8f7-e9e4-1.png)

找到压缩包

vol.py -f chall.vmem --profile=Win7SP1x64 mimikatz

![](images/20250213162455-016509e8-e9e4-1.png)

mrl64l0v3miku

这个是密码，解压得flag

![](images/20250213162456-01e4444a-e9e4-1.png)

#### [GHCTF 2024 新生赛]是名取证

vol.py -f chall.vmem --profile=Win7SP1x64 iehistory

![](images/20250213162457-02757157-e9e4-1.png)

vol.py -f chall.vmem --profile=Win7SP1x64 memdump -p 1836 -D ./..

![](images/20250213162458-03158636-e9e4-1.png)

strings explorer.exe | grep flag

![](images/20250213162459-03a6166f-e9e4-1.png)

#### [GHCTF 2024 新生赛]佛说取证

vol.py -f chall.vmem --profile=Win7SP1x64 clipboard

![](images/20250213162500-04644231-e9e4-1.png)

jingangjing

![](images/20250213162501-0504d748-e9e4-1.png)

### **[NSSRound#12 Basic]ordinary forensics**

vol.py -f forensics.raw --profile=Win7SP1x64 cmdscan

![](images/20250213162502-05970f56-e9e4-1.png)

找到了一个密码U\_find\_1t

vol.py -f forensics.raw --profile=Win7SP1x64 filescan | grep zip·

![](images/20250213162503-0647bc4c-e9e4-1.png)

提取这个压缩包

vol.py -f forensics.raw --profile=Win7SP1x64 dumpfiles -Q 0x000000007f2b88b0 -D ./..

![](images/20250213162504-06d20860-e9e4-1.png)

用上面的密码解压得到一个文本

![](images/20250213162505-075948cd-e9e4-1.png)

再提取一下这个文本

![](images/20250213162506-07d11412-e9e4-1.png)

内容：你知道vera吗

用veracrypt挂载

![](images/20250213162507-08526546-e9e4-1.png)

得到一个secret的文件

![](images/20250213162507-08b0a138-e9e4-1.png)

挂载

![](images/20250213162508-091c881f-e9e4-1.png)

得到一个压缩包

![](images/20250213162509-097453e5-e9e4-1.png)

提示密码格式为username\_hostname

vol.py -f forensics.raw --profile=Win7SP1x64 mimikatz

得到username和hostname

密码：Mario\_Princess-Peach

![](images/20250213162510-09f04e8c-e9e4-1.png)

NSSCTF{f0rens1cs\_1s\_Interesting}

### **[腾龙杯 2024]easy\_Forensics**

vol.py -f 3.img --profile=Win7SP1x64 filescan | grep -E "png|zip|rar|jpg|txt"

找到一张图片

![](images/20250213162511-0aa9e586-e9e4-1.png)

提取出来发现有压缩包

![](images/20250213162512-0b9f5358-e9e4-1.png)

分离出来

![](images/20250213162513-0c3a493b-e9e4-1.png)

解压得镜像

![](images/20250213162514-0c9d6f57-e9e4-1.png)

导出来

镜像里面是一个hint.txt

打开是坐标，需要画图

直接用gnuplot画图

![](images/20250213162515-0d01b9a0-e9e4-1.png)

![](images/20250213162515-0d6bcff8-e9e4-1.png)

解码就行

Here is the vigenere key: aeolus, but i deleted the encrypted message。

得到一个维吉尼亚的key，需要明文

在这个文件夹里面发现一个文件

![](images/20250213162516-0dcd9578-e9e4-1.png)

![](images/20250213162517-0e425903-e9e4-1.png)

yispywt!nidn\_xirr\_lhv\_sszgy

![](images/20250213162517-0ea3d4cf-e9e4-1.png)

flag{yeeeeet!just\_find\_and\_solve}

### DASCTF

#### baby\_misc

查看文件，在导出这个文件

vol.py -f baby\_misc.raw --profile=Win7SP1x64 filescan | grep txt

![](images/20250213162519-0f67f639-e9e4-1.png)

![](images/20250213162520-10420336-e9e4-1.png)

再导出压缩包

vol.py -f baby\_misc.raw --profile=Win7SP1x64 dumpfiles -Q 0x000000003e7d2650 -D ./..

![](images/20250213162521-10d8c49f-e9e4-1.png)

查看一下进程导出这个文件

vol.py -f baby\_misc.raw --profile=Win7SP1x64 memdump -p 1516 -D ./..

![](images/20250213162522-119fe552-e9e4-1.png)

用gimp查看

![](images/20250213162524-126b171e-e9e4-1.png)

132424464

用windowns模块查看

vol.py -f baby\_misc.raw --profile=Win7SP1x64 windows | grep 132424464

![](images/20250213162525-131a4cc0-e9e4-1.png)

16进制得到解压密码

![](images/20250213162526-13752fe2-e9e4-1.png)

^&G12BDd

得到flag

flag{fba99a87-2278-f175-5055-a47f5773c131}

### **2021陇剑杯-内存取证**

#### 内存分析（问1）

```
网管小王制作了一个虚拟机文件，让您来分析后作答：
虚拟机的密码是_____________。（密码中为flag{xxxx}，含有空格，提交时不要去掉）。
```

mimikatz一把梭了

![](images/20250213162526-13e36b53-e9e4-1.png)

flag{W31C0M3 T0 THiS 34SY F0R3NSiCX}

#### 内存分析（问2）

```
网管小王制作了一个虚拟机文件，让您来分析后作答：
虚拟机中有一个某品牌手机的备份文件，文件里的图片里的字符串为_____________。（解题过程中需要用到上一题答案中flag{}内的内容进行处理。本题的格式也是flag{xxx}，含有空格，提交时不要去掉）。
```

先查看信息

vol.py -f Target.vmem imageinfo

查看一下桌面文件

vol.py -f Target.vmem --profile=Win7SP1x64 filescan | grep Desk

![](images/20250213162527-14785d5e-e9e4-1.png)

提取一下

vol.py -f Target.vmem --profile=Win7SP1x64 dumpfiles -Q 0x000000007d8c7d10 -D ./..

![](images/20250213162528-152a3eac-e9e4-1.png)

再文件分离一下，得到华为的文件夹

<https://github.com/RealityNet/kobackupdec>用这个软件解密

密码是上题的W31C0M3\_T0\_THiS\_34SY\_F0R3NSiCX

```
python kobackupdec.py -vvv W31C0M3_T0_THiS_34SY_F0R3NSiCX "HUAWEI P40_2021-aa-bb xx.yy.zz" D:\666
```

![](images/20250213162529-15bd883a-e9e4-1.png)

![](images/20250213162530-16354c34-e9e4-1.png)

flag{TH4NK Y0U FOR DECRYPTING MY DATA}

### **2022鹏城杯-简单取证**

查看信息，找文件

```
vol.py -f file.raw imageinfo
vol.py -f file.raw --profile=WinXPSP2x86 filescan | grep jpg
```

![](images/20250213162531-16dfd956-e9e4-1.png)

导出来

vol.py -f file.raw --profile=WinXPSP2x86 dumpfiles -Q 0x0000000002325028 -D ./..

去010显示是BASE64，赛博厨子一把梭了

![](images/20250213162533-17f11020-e9e4-1.png)

压缩包导出来

找到密码

vol.py -f file.raw --profile=WinXPSP2x86 cmdscan

![](images/20250213162534-1891a508-e9e4-1.png)

解压出来是坐标，用脚本

```
from PIL import Image

im = Image.new("RGB", (350, 350), (0, 0, 0))

with open("flag.txt", "r") as f:
    r = f.read()

lst = r.split("
")
for i in lst:
    x = int(i.split(" ")[0])
    y = int(i.split(" ")[1])
    im.putpixel((x, y), (255, 255, 255))

im.save("flag.png")
```

![](images/20250213162535-194bd979-e9e4-1.png)

flag{a6b93e36-f097-11ec-a9b2-5254002d2b31}

### **2023巅峰极客**

#### easy\_Forensic

先查看镜像信息，

vol.py -f secret.raw imageinfo

再查看进程

vol.py -f secret.raw --profile=Win7SP1x64 pslist

![](images/20250213162537-1a1c4cb5-e9e4-1.png)

没什么用

再获取文件

vol.py -f secret.raw --profile=Win7SP1x64 filescan

![](images/20250213162539-1b5cd3ab-e9e4-1.png)

发现了一个压缩包

![](images/20250213162540-1c308ec4-e9e4-1.png)

一个jpg

![](images/20250213162541-1caaf2ee-e9e4-1.png)

一个txt文本

![](images/20250213162542-1d1389fa-e9e4-1.png)

或者直接过滤

vol.py -f secret.raw --profile=Win7SP1x64 filescan | grep txt

![](images/20250213162542-1d841c0f-e9e4-1.png)

把它们都dump下来

vol.py -f secret.raw --profile=Win7SP1x64 dumpfiles -Q 0x000000007d84af20 -D ./

hint.txt dump不下来

再来看一下图片，左下角有东西，修改宽高

![](images/20250213162543-1df6f549-e9e4-1.png)

得到压缩包的密码：Nothing\_is\_more\_important\_than\_your\_life!

![](images/20250213162544-1e65cae6-e9e4-1.png)

![](images/20250213162545-1edf4b9a-e9e4-1.png)

可以看到gift里的内容应该是个密钥，wechat是聊天记录

<https://github.com/x1hy9/WeChatUserDB>，用这个来解

![](images/20250213162545-1f44589f-e9e4-1.png)

![](images/20250213162546-1fb900c7-e9e4-1.png)

![](images/20250213162547-202585c5-e9e4-1.png)

flag{The\_Is\_Y0ur\_prize}

### **24鹏城杯-取证**

vol.py -f flag.raw imageinfo

![](images/20250213162548-20c4b259-e9e4-1.png)

vol.py -f flag.raw --profile=Win7SP1x64 filescan | grep -E "png|jpg|rar|zip|Desktop"

![](images/20250213162549-218bfad8-e9e4-1.png)

找到压缩包

![](images/20250213162550-221f0345-e9e4-1.png)

密码爆破

u3=LEnoG9HX2fJPVyIUpjax+8CSqsBOYWmzekwA1Z5grM0F/6DTNhQb4dKlR7tivc

得到这个

考虑到需要base64换表

![](images/20250213162551-22998b3a-e9e4-1.png)

![](images/20250213162552-2312e49c-e9e4-1.png)

CADmC4MN8NfdfoJePLj4JNsdfLW6CeJmfAIAJxE68eIkJLBkf4hc

再解码

![](images/20250213162553-239021b2-e9e4-1.png)

得到flag

flag{3c380cc857778080f3a2df5a0b4d47d3}

### [湖湘杯 2021]某取证题

我们先导出这张图片

```
vol.py -f PC11.raw --profile=Win7SP1x64 filescan | grep jpg
vol.py -f PC11.raw --profile=Win7SP1x64 dumpfiles -Q 0x000000007e353630 -D ./..
```

![](images/20250213162554-243a562d-e9e4-1.png)

得到一部分flag

![](images/20250213162556-25d11675-e9e4-1.jpeg)

查看一下ie浏览器的记录，太多了，就过滤一下

vol.py -f PC11.raw --profile=Win7SP1x64 iehistory | grep zip

![](images/20250213162603-29b1b65d-e9e4-1.png)

在计算机中没有找到zip文件，就在进程中看到了Wireshark.exe

导出来

vol.py -f PC11.raw --profile=Win7SP1x64 memdump -p 1096 -D ./..

![](images/20250213162604-2a63a1e6-e9e4-1.png)

文件分离找到了压缩包

需要明文攻击

./bkcrack -L target.zip

![](images/20250213162605-2ae8a921-e9e4-1.png)

太慢了

./bkcrack -C target.zip -c t.jpg -x 0 ffd8ffe000104a46494600

![](images/20250213162606-2b70b0a0-e9e4-1.png)

更改一下密码

./bkcrack -C target.zip -k b0a90b36 14dd97b9 f5d648cf -U flag.zip 123456

![](images/20250213162607-2c073a73-e9e4-1.png)

over

![](images/20250213162608-2cafd04b-e9e4-1.jpeg)

flag{2911364c-7f0c-4d37-b92c-accaf9d1de2d}
